
graph = {
	"device1":{
		"name1": ["anil1", "anil2"],
		"name2": ["anil3", "anil4"]
	},
	"device2":{
		"name1": ["anil1", "anil2"],
		"name2": ["anil3", "anil4"]
	},
}

graph = {
	405: {
		'SNMPUptime-0': [1627107683000, 1627107083000, 1627106483000, 1627105883000, 1627105283000, 1627104683000],
		'Sonus_License_Usage': [1627107768000, 1627107588000, 1627107408000, 1627107228000, 1627107048000, 1627106868000, 1627106688000, 1627106508000, 1627106328000, 1627106148000, 1627105968000, 1627105788000, 1627105608000, 1627105428000, 1627105248000, 1627105068000, 1627104888000, 1627104708000, 1627104528000, 1627104348000],
		'Sonus_lmsupport_clone': [1627107785000, 1627107725000, 1627107665000, 1627107605000, 1627107545000, 1627107485000, 1627107425000, 1627107365000, 1627107305000, 1627107245000, 1627107185000, 1627107125000, 1627107065000, 1627107005000, 1627106945000, 1627106885000, 1627106825000, 1627106765000, 1627106705000, 1627106645000, 1627106585000, 1627106525000, 1627106465000, 1627106405000, 1627106345000, 1627106285000, 1627106225000, 1627106165000, 1627106105000, 1627106045000, 1627105985000, 1627105925000, 1627105865000, 1627105805000, 1627105745000, 1627105685000, 1627105625000, 1627105565000, 1627105505000, 1627105445000, 1627105385000, 1627105325000, 1627105265000, 1627105205000, 1627105145000, 1627105085000, 1627105025000, 1627104965000, 1627104905000, 1627104845000, 1627104785000, 1627104725000, 1627104665000, 1627104605000, 1627104545000, 1627104485000, 1627104425000, 1627104365000, 1627104305000, 1627104245000],
		'SonusCalls': [1627107627000, 1627107327000, 1627107027000, 1627106727000, 1627106427000, 1627106127000, 1627105827000, 1627105527000, 1627105227000, 1627104927000, 1627104627000, 1627104327000]
	},
	398: {},
	192: {
		'SNMPUptime-0': [1627107761000, 1627107161000, 1627106561000, 1627105961000, 1627105361000, 1627104761000]
	},
	978: {
		'SNMPUptime-0': [1627107338000, 1627106738000, 1627106138000, 1627105538000, 1627104938000, 1627104338000],
		'Sonus_License_Usage': [1627107741000, 1627107561000, 1627107381000, 1627107201000, 1627107021000, 1627106841000, 1627106661000, 1627106481000, 1627106301000, 1627106121000, 1627105941000, 1627105761000, 1627105581000, 1627105401000, 1627105221000, 1627105041000, 1627104861000, 1627104681000, 1627104501000, 1627104321000],
		'Sonus_lmsupport_clone': [1627107857000, 1627107797000, 1627107737000, 1627107677000, 1627107617000, 1627107557000, 1627107497000, 1627107437000, 1627107377000, 1627107317000, 1627107257000, 1627107197000, 1627107137000, 1627107077000, 1627107017000, 1627106957000, 1627106897000, 1627106837000, 1627106777000, 1627106717000, 1627106657000, 1627106597000, 1627106537000, 1627106477000, 1627106417000, 1627106357000, 1627106297000, 1627106237000, 1627106177000, 1627106117000, 1627106057000, 1627105997000, 1627105937000, 1627105877000, 1627105817000, 1627105757000, 1627105697000, 1627105637000, 1627105577000, 1627105517000, 1627105457000, 1627105397000, 1627105337000, 1627105277000, 1627105217000, 1627105157000, 1627105097000, 1627105037000, 1627104977000, 1627104917000, 1627104857000, 1627104797000, 1627104737000, 1627104677000, 1627104617000, 1627104557000, 1627104497000, 1627104437000, 1627104377000, 1627104317000],
		'SonusCalls': [1627107720000, 1627107420000, 1627107120000, 1627106820000, 1627106520000, 1627106220000, 1627105920000, 1627105620000, 1627105320000, 1627105020000, 1627104720000, 1627104420000]
	},
	979: {
		'SNMPUptime-0': [1627107826000, 1627107226000, 1627106626000, 1627106026000, 1627105426000, 1627104826000],
		'Sonus_License_Usage': [1627107727000, 1627107547000, 1627107367000, 1627107187000, 1627107007000, 1627106827000, 1627106647000, 1627106467000, 1627106287000, 1627106107000, 1627105927000, 1627105747000, 1627105567000, 1627105387000, 1627105207000, 1627105027000, 1627104847000, 1627104667000, 1627104487000, 1627104307000],
		'Sonus_lmsupport_clone': [1627107875000, 1627107815000, 1627107755000, 1627107695000, 1627107635000, 1627107575000, 1627107515000, 1627107455000, 1627107395000, 1627107335000, 1627107275000, 1627107215000, 1627107155000, 1627107095000, 1627107035000, 1627106975000, 1627106915000, 1627106855000, 1627106795000, 1627106735000, 1627106675000, 1627106615000, 1627106555000, 1627106495000, 1627106435000, 1627106375000, 1627106315000, 1627106255000, 1627106195000, 1627106135000, 1627106075000, 1627106015000, 1627105955000, 1627105895000, 1627105835000, 1627105775000, 1627105715000, 1627105655000, 1627105595000, 1627105535000, 1627105475000, 1627105415000, 1627105355000, 1627105295000, 1627105235000, 1627105175000, 1627105115000, 1627105055000, 1627104995000, 1627104935000, 1627104875000, 1627104815000, 1627104755000, 1627104695000, 1627104635000, 1627104575000, 1627104515000, 1627104455000, 1627104395000, 1627104335000],
		'SonusCalls': [1627107621000, 1627107321000, 1627107021000, 1627106721000, 1627106421000, 1627106121000, 1627105821000, 1627105521000, 1627105222000, 1627104921000, 1627104621000, 1627104321000]
	},
	1219: {
		'SNMPUptime-0': [1627107684000, 1627107084000, 1627106484000, 1627105884000, 1627105284000, 1627104684000],
		'Sonus_License_Usage': [1627107769000, 1627107484000, 1627107304000, 1627107124000, 1627106944000, 1627106764000, 1627106595000, 1627106415000, 1627106211000, 1627106031000, 1627105845000, 1627105590000, 1627105410000, 1627105361000, 1627105181000, 1627105001000, 1627104768000, 1627104588000, 1627104429000],
		'Sonus_lmsupport_clone': [1627107879000, 1627107819000, 1627107759000, 1627107699000, 1627107639000, 1627107579000, 1627107519000, 1627107459000, 1627107399000, 1627107339000, 1627107279000, 1627107219000, 1627107159000, 1627107099000, 1627107039000, 1627106979000, 1627106919000, 1627106859000, 1627106799000, 1627106739000, 1627106679000, 1627106619000, 1627106559000, 1627106499000, 1627106439000, 1627106379000, 1627106319000, 1627106259000, 1627106199000, 1627106139000, 1627106079000, 1627106019000, 1627105959000, 1627105899000, 1627105839000, 1627105779000, 1627105719000, 1627105659000, 1627105599000, 1627105539000, 1627105479000, 1627105419000, 1627105359000, 1627105299000, 1627105239000, 1627105179000, 1627105119000, 1627105059000, 1627104999000, 1627104939000, 1627104879000, 1627104819000, 1627104759000, 1627104699000, 1627104639000, 1627104579000, 1627104519000, 1627104459000, 1627104399000, 1627104339000],
		'SonusCalls': [1627107725000, 1627107426000, 1627107125000, 1627106825000, 1627106525000, 1627106225000, 1627105925000, 1627105625000, 1627105325000, 1627105025000, 1627104725000, 1627104425000]
	},
	1220: {
		'SNMPUptime-0': [1627107820000, 1627107220000, 1627106620000, 1627106020000, 1627105420000, 1627104821000],
		'Sonus_License_Usage': [1627107808000, 1627107628000, 1627107434000, 1627107254000, 1627107074000, 1627106894000, 1627106714000, 1627106568000, 1627106388000, 1627106244000, 1627106064000, 1627105867000, 1627105687000, 1627105594000, 1627105414000, 1627105293000, 1627105113000, 1627104933000, 1627104727000, 1627104416000],
		'Sonus_lmsupport_clone': [1627107921000, 1627107861000, 1627107801000, 1627107741000, 1627107681000, 1627107621000, 1627107561000, 1627107501000, 1627107441000, 1627107381000, 1627107321000, 1627107261000, 1627107201000, 1627107141000, 1627107081000, 1627107021000, 1627106961000, 1627106901000, 1627106841000, 1627106781000, 1627106721000, 1627106661000, 1627106601000, 1627106541000, 1627106481000, 1627106421000, 1627106361000, 1627106301000, 1627106241000, 1627106181000, 1627106121000, 1627106061000, 1627106001000, 1627105941000, 1627105881000, 1627105821000, 1627105761000, 1627105701000, 1627105641000, 1627105581000, 1627105521000, 1627105461000, 1627105401000, 1627105341000, 1627105281000, 1627105221000, 1627105161000, 1627105101000, 1627105041000, 1627104981000, 1627104921000, 1627104861000, 1627104801000, 1627104741000, 1627104681000, 1627104621000, 1627104561000, 1627104501000, 1627104441000, 1627104381000],
		'SonusCalls': [1627107865000, 1627107565000, 1627107265000, 1627106965000, 1627106665000, 1627106365000, 1627106065000, 1627105766000, 1627105465000, 1627105165000, 1627104865000, 1627104565000]
	}
}
import pandas as pd

# writer = pd.ExcelWriter('pandas_multiple.xlsx', engine='xlsxwriter')
#
# for key in graph.keys():
#     df = pd.DataFrame({key: graph[key]})
#     df.to_excel(writer, sheet_name=key)
# writer.save()

# Create a Pandas Excel writer using XlsxWriter as the engine.

import datetime


for device in graph.keys():
	writer = pd.ExcelWriter('{}.xlsx'.format(device), engine='xlsxwriter')
	for key in graph[device].keys():
		# import pdb
		# pdb.set_trace()

		# datetime_time = datetime.datetime.fromtimestamp(epoch_time)
		new_list = []
		for element in graph[device][key]:
			dat = datetime.datetime.fromtimestamp(element / 1000)
			out = dat.strftime('%a, %d %b %Y %H:%M:%S IST')
			new_list.append(out)

		df = pd.DataFrame({key: new_list})
		df.to_excel(writer, sheet_name=key)
	writer.save()


# df = pd.DataFrame({key: graph[key]})
# df.to_excel(writer, sheet_name=key)
# writer.save()

# df = pd.DataFrame({key: graph[key]})
#     df.to_excel(writer, sheet_name=key)
# writer.save()

# for j in range(10,20):
#     print(j)
